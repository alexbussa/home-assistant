##############################################################
# Home Theater On
##############################################################
- alias: Enable Home Theater On Lighting
  trigger:
    platform: state
    entity_id: input_boolean.mode_home_theater
    from: 'off'
    to: 'on'
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_boolean.mode_morning
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_sunset
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_night
        state: 'on'
  action:
    - service: script.turn_on
      entity_id: script.update_scene
      data:
        variables:
          lights: 'living_room,living_room_tv,rec_room_tiles'
- alias: Restore Home Theater Off Lighting
  trigger:
    platform: state
    entity_id: input_boolean.mode_home_theater
    from: 'on'
    to: 'off'
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_boolean.mode_morning
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_sunset
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_night
        state: 'on'
  action:
    - service: script.turn_on
      entity_id: script.update_scene
      data:
        variables:
          lights: 'living_room,living_room_tv,rec_room_tiles'


##############################################################
# Home Theater Playing
##############################################################
# Enhance with "restore" input_boolean for kitchen & living room
- alias: Enable Home Theater Playing Lighting
  trigger:
    - platform: state
      entity_id: media_player.living_room_apple_tv
      from: 'idle'
      to: 'playing'
    - platform: state
      entity_id: media_player.living_room_apple_tv
      from: 'paused'
      to: 'playing'
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_boolean.mode_morning
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_sunset
        state: 'on'
      - condition: state
        entity_id: input_boolean.mode_night
        state: 'on'
  action:
    - service: script.turn_on
      entity_id: script.update_scene
      data:
        variables:
          lights: 'kitchen,rec_room_tiles,living_room,living_room_tv'
# Enhance with "restore" input_boolean for kitchen & living room
- alias: Restore Home Theater On Lighting
  trigger:
    - platform: state
      entity_id: media_player.living_room_apple_tv
      from: 'playing'
      to: 'paused'
      for:
        seconds: 10
    - platform: state
      entity_id: media_player.living_room_apple_tv
      from: 'playing'
      to: 'idle'
    - platform: state
      entity_id: media_player.living_room_apple_tv
      from: 'paused'
      to: 'idle'
  action:
    - service: script.turn_on
      entity_id: script.update_scene
      data:
        variables:
          lights: 'living_room,living_room_tv,rec_room_tiles,kitchen'
